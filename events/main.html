<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <title>GetWorkDone - Home</title>
   <link rel="stylesheet" type="text/css" href="../style.css"/>

   <script src="https://apis.google.com/js/client:platform.js" async defer></script>

   <!-- Links and script for calendar-->
   <link rel='stylesheet' href='../fullcalendar/fullcalendar.css' />
   <script src='../lib/jquery-2.1.3.min.js'></script>
   <script src='../lib/moment.min.js'></script>
   <script src='../fullcalendar/fullcalendar.js'></script>

</head>

<body>
   <script>
      $(document).ready(function() {

         var date = new Date();
         var d = date.getDate();
         var m = date.getMonth();
         var y = date.getFullYear();

         var calendar = $('#calendar').fullCalendar({
            header: {
               left: 'prev,next today',
               center: 'title',
               right: 'month,agendaWeek,agendaDay'
            },
                                                    
            defaultView: 'month',
        //allows to be resized in week/day view, as well as moved around
            editable :true,
            selectable: true,
            selectHelper: true,
                                                    
                                                    
        //if we click on a event,a popup will appear asking if we wish to delete it, if cancel, another will appear and ask to edit
            eventClick: function(calEvent, jsEvent, view){
                var r=confirm("Delete " + calEvent.title);
                var e=confirm("edit" + calEvent.title);
                if (r===true)
                {
                    calendar.fullCalendar('removeEvents', calEvent._id);
            
                                                    }
               else if(e==true){
                    var newTitle = prompt('New event title:');
                    if (newTitle) {
                                                    calEvent.title = newTitle;
                                                    calendar.fullCalendar('updateEvent', calEvent);
                                    }
                }
                                                    
          },


                                                    
                                                    
            eventDrop: function() {
            },
            
        select: function(start, end, allDay) {
                                                    window.open("newevent.html");
//           var title = prompt('Event Title:');
//
//           if (title) {
//              calendar.fullCalendar('renderEvent', {
//                 title: title,
//                 start: date
//              },
//              true);
//           }
//           calendar.fullCalendar('unselect');
        }
                                                    
                                                    
         })
      

      var query = window.location.search;

      // Skip the leading ?, which should always be there,
      // but be careful anyway
      if (query.substring(0, 1) == '?') {
         query = query.substring(1);
      }

      var data = query.split(',');

      for(i = 0; i < data.length; i++) {
         data[i] = unescape(data[i]);
      }
//                        var date = "" + data[2];
//                        var time = "" +data[3];
//                        var res = data[2].substr(0,8);
//                        data[2]= data[2]+"" + (res+1)
//                        var startDate= new Date(date.substr(0,4), date.substr(5,2), date.substr(8,2), time.substr(0,2), time.substr(3,2),0,0);
                        var startDate = new Date(data[2]+""+data[3]);
                        var endDate = new Date(data[4]+""+data[4]);
                        var startDate =startDate + "";
  calendar.fullCalendar('renderEvent',
           {
           title: data[0],
            start: startDate,
            end: endDate
           },
           true)
                        
});


   </script>
   <nav>
      <ul>
         <li><a href="../index.html">HOME</a></li>
         <li><a href="../accountSettings.html">ACCOUNT SETTINGS</a></li>
      </ul>
   </nav>
   
   <table>
      <tr>
         <td>
            <span id="signinButton">
            <span
            class="g-signin"
            data-callback="signinCallback"
            data-clientid="36651784653-cb9lghukoo8mov2ilfskr43l7l085jd6.apps.googleusercontent.com"
            data-cookiepolicy="single_host_origin"
            data-requestvisibleactions="http://schema.org/AddAction"
            data-scope="https://www.googleapis.com/auth/plus.login">
            </span>
         </span>
               <a href="newevent.html"><img src="../img/button_add.png" alt="Add Event"></a>
            <img src="../img/button_delete.png" alt="Delete Event" height="30" width="100">
            <h3>Calender</h3> 
            <!-- This div contain the calendar -->
            <div id='calendar'></div>
         </td>
         
         <td>

            <h3>List</h3>
            <ol>
               <li>Birthday Party</li>
               <li>Assignment B Due</li>
               <li>Quiz tomorrow</li>
               <script>
                   var query = window.location.search;
                   
                   // Skip the leading ?, which should always be there,
                   // but be careful anyway
                   if (query.substring(0, 1) == '?') {
                       query = query.substring(1);
                   }
               
               var data = query.split(',');
               
               for(i = 0; i < data.length; i++) {
                   data[i] = unescape(data[i]);
               }

var date = "" + data[2];
var time = "" +data[3];
//                        var res = data[2].substr(0,8);
//                        data[2]= data[2]+"" + (res+1)
var startDate= new Date(date.substr(0,4), date.substr(5,2), date.substr(8,2), time.substr(0,2), time.substr(3,2),0,0);

                   document.write("<li>" + startDate + " " + "</li>\n");
                  //if (data.length == 6) {
//                     for(i = 0; i < data.length; i++) {
//                        document.write("<li>" + data[i] + " " + "</li>\n");
//                     }
                  //}
               </script>
            </ol>
         </td>
      </tr>
   </table>
   <div id="calendar"></div>
   <div id="dialog" title="My dialog" style="display:none">
       <form>
           <fieldset>
               <label for="Id">Id</label>
               <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all">
                   <label for="Id">Title</label>
                   <input type="text" name="title" id="title" class="text ui-widget-content ui-corner-all">
           </fieldset>
       </form>
   </div>
   <footer>
      <p><small>&copy; GetWorkDone 2015</small></p>
   </footer>
</body>
</html>